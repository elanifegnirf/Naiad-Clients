#!/bin/bash

# start the build setup...

echo "NAIAD_PATH:" $NAIAD_PATH
echo "DEV_ROOT_NCLIENTS:" $DEV_ROOT_NCLIENTS
echo "EM_ARCH:" $EM_ARCH
echo "EM_PLAT:" $EM_PLAT
echo "EM_COMPILER:" $EM_COMPILER

rm -rf $DEV_ROOT_NCLIENTS/stage-$EM_PLAT-$EM_ARCH
mkdir  $DEV_ROOT_NCLIENTS/stage-$EM_PLAT-$EM_ARCH

cd $DEV_ROOT_NCLIENTS/stage-$EM_PLAT-$EM_ARCH
mkdir debug
mkdir release
mkdir dist

cd debug
if [[ $EM_PLAT == 'WINDOWS' ]]; then
    cmake -DCMAKE_BUILD_TYPE=DEBUG -DCMAKE_INSTALL_PREFIX=$NAIAD_PATH $DEV_ROOT_NCLIENTS -G "Visual Studio 10 Win64"
else
    cmake -DCMAKE_BUILD_TYPE=DEBUG -DCMAKE_INSTALL_PREFIX=$NAIAD_PATH $DEV_ROOT_NCLIENTS
fi

cd ..
cd release
if [[ $EM_PLAT == 'WINDOWS' ]]; then
    cmake -DCMAKE_BUILD_TYPE=RELEASE -DCMAKE_INSTALL_PREFIX=$NAIAD_PATH $DEV_ROOT_NCLIENTS -G "Visual Studio 10 Win64"
else
    cmake -DCMAKE_BUILD_TYPE=RELEASE -DCMAKE_INSTALL_PREFIX=$NAIAD_PATH $DEV_ROOT_NCLIENTS
fi

cd ..
cd dist
if [[ $EM_PLAT == 'WINDOWS' ]]; then
    cmake -DDIST_BUILD_TYPE=1 -DCMAKE_BUILD_TYPE=RELEASE -DCMAKE_INSTALL_PREFIX=$NAIAD_PATH $DEV_ROOT_NCLIENTS -G "Visual Studio 10 Win64"
else 
    cmake -DDIST_BUILD_TYPE=1 -DCMAKE_BUILD_TYPE=RELEASE -DCMAKE_INSTALL_PREFIX=$NAIAD_PATH $DEV_ROOT_NCLIENTS
fi
